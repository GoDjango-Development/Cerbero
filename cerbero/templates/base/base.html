{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <link rel="icon" href="{% static 'img/logo.png' %}" type="image/png"  />
    <title>
      {% block title %}

      {% endblock %}
    </title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="{% static 'lib/fontawesome-free/css/all.min.css' %}" />
    <!-- Theme style -->
    <link rel="stylesheet" href="{% static 'lib/adminlte-3.1.0/css/adminlte.min.css' %}" />
    <!-- jQuery -->
    <script src="{% static 'lib/jquery/jquery.min.js' %}"></script>
    <!-- Bootstrap 4 -->
    <script src="{% static 'lib/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- Sweetalert2 -->
    <script src="{% static 'lib/sweetalert2-9.10.0/sweetalert2.all.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/sweetalert2-9.10.0/sweetalert2.min.css' %}" />

    <script src="{% static 'lib/toastr/toastr.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/toastr/toastr.min.css' %}" />

    <script src="{% static 'lib/highcharts-8.1.2/highcharts.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/exporting.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/export-data.js' %}"></script>
    <script src="{% static 'lib/highcharts-8.1.2/modules/accessibility.js' %}"></script>
    <link rel="stylesheet" href="{% static 'lib/datatables-1.10.20/css/dataTables.bootstrap4.min.css' %}" />
    <link rel="stylesheet" href="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/css/responsive.bootstrap4.min.css' %}" />
    <script src="{% static 'lib/datatables-1.10.20/js/jquery.dataTables.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/js/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/js/responsive.bootstrap4.min.js' %}"></script>
    <style></style>
    <link rel="stylesheet" href="{% static 'lib/datatables-1.10.20/css/dataTables.bootstrap4.min.css' %}" />
    <link rel="stylesheet" href="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/css/responsive.bootstrap4.min.css' %}" />
    <script src="{% static 'lib/datatables-1.10.20/js/jquery.dataTables.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/js/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/plugins/responsive-2.2.3/js/responsive.bootstrap4.min.js' %}"></script>

    <script src="{% static 'lib/adminlte-3.1.0/js/adminlte.min.js' %}"></script>
    <script src="{% static 'lib/chart.js/chart.min.js' %}"></script>
    <script>
      // Función para obtener la duración de la sesión en segundos
      function obtenerDuracionSesion() {
        // Aquí debes proporcionar la duración de la sesión en segundos
        // Puedes obtenerla desde tu backend o establecerla manualmente
        return 1; // 30 minutos
      }
    
      
    
      // Función para mostrar la notificación persistente
      function mostrarNotificacion() {
        Toastify({
          text: "Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",
          duration: -1, // Duración infinita
          close: true,
          onClick: function() { 
            Toastify({
              text: "Tu sesión ha expirado. Por favor, inicia sesión nuevamente.",
              duration: -1, // Duración infinita
              close: true,
              onClick: function() { 
                // Redirigir al usuario a la URL de inicio de sesión en Django
                window.location.href = "{% url 'login' %}";
              }
            }).showToast();
          }
        }).showToast();
      }
    
      // Función para redirigir al usuario a la URL de inicio de sesión en Django
      function redirigirALogin() {
        window.location.href = "{% url 'login' %}";
      }
    
      // Función para verificar el tiempo de inactividad y mostrar la notificación si la sesión ha expirado
      function verificarInactividad() {
        console.log('entre aca ya')
        var duracionSesion = obtenerDuracionSesion();
        var marcaTiempoUltimaActividad = obtenerMarcaTiempoUltimaActividad();
        var tiempoTranscurrido = Math.floor(Date.now() / 1000) - marcaTiempoUltimaActividad;
    
        if (tiempoTranscurrido >= duracionSesion) {
          mostrarNotificacion();
          redirigirALogin();
        }
      }
    
      // Ejecutar la verificación de inactividad al cargar la página
      window.onload = function() {
        verificarInactividad();
      };
    </script>
    <style></style>

    <!-- Functions -->
    <!-- Block head -->
    {% block head %}

    {% endblock %}
  </head>
  {% block body %}

  {% endblock %}
</html>
